
## Создание всплывающих окон с произвольным блоком в качестве содержимого этого окна.
Шаблон ff/popups служит лишь оберткой в виде модального окна modal от Bootsrap 3.

Сам же плагин всплывающего окна ff/popups/popups.js может работать независимо.
То есть, чтобы создать всплывающее окно достаточно только папки ff/popups, а файлы ff/popups.tdd и ff/popups.tpl необязательны.

### 1. Модальное окно

	На страницах, где применяется кнопка вызова всплывающего окна, вставьте код:
	Blox::addToFoot(Blox::info('templates','url').'/ff/popups/popups.js');
	Если заранее неизвестно, где понадобятся кнопки, выводите код модального окна на всех страницах, то есть, запишите этот код в шаблоне page.tpl
	
	Если в модальное окно через ajax загружается форма на шаблоне ff/form, то на страницах, где она вызывается, необходимо также подключить файлы:
	Blox::addToFoot(Blox::info('cms','url').'/assets/jquery.form.min.js');
	Blox::addToHead(Blox::info('templates','url').'/ff/form/form.css');
	
### 2. Кнопка вызова всплывающего окна

	Вставьте кнопку вызова всплывающего окна там, где вам нужно (в файле шаблона или в окне редактирования)
	<button data-ff-popups-url="?block=15">Написать письмо</button>
	В атрибуте должен быть указан URL источника html-кода. Обычно это запрос к блоку.
	---В текущей версии допустимы только относительные параметрические (?block=...) или абсолютные (http...) URL

### 3.  Обертка модального окна

	Если вызывать произвольный блок, как это было описано выше, то блок появится, как есть, без контейнера и кнопки закрывания окна (хотя окно всегда можно закрыть, если кликнуть мимо окна).
	Чтобы иметь обертку (контейнер) нужного размера, с заголовком и т.п., необходимо вызывать не сам блок, а блок на шаблоне ff/popups, внутрь которого и назначить нужный блок.
	В этом случае нужно вызывать, естесвенно, блок обертки. Шаблон ff/popups многозаписный, поэтому нужно вызывать не просто блок, а нужную запись блока запросом single.
	<button data-ff-popups-url="?block=22&single=1">Заказать</button>

### 4. Передача данных в обертку и целевой блок 

	Дополнительные данные можно передать в том же атрибуте data-ff-popups-url в дополнительных url-параметрах.
	Все передаваемые данные для надежности желательно преобразовать  с помощью php-функции urlencode():
	<button data-ff-popups-url="?block=22&single=1&ff-popups[1]=<?=urlencode('Заявка на смартфон')?>">Заказать</button>
	Имя параметра рекомендуется выбирать по имени шаблона, в который передаются данные.
	Передаванные в шаблон данные доступны в суперглобальном массиве $_GET.
	
	В частности, для передачи данных в обертку зарезервирован параметр-массив ff-popups с целочисленными ключами, соответствующими полям шаблона ff/popups (см. пример выше).
	А, например,  на форму ff/form, назначенную во всплывающее окно, данные можно передать так: 
	<button data-ff-popups-url="?block=22&single=1&ff-form[data][product]=...&ff-form[data][description]=...">Заказать</button>

	Кстати, данные, переданные в шаблон ff/form, автоматически встают в поля формы, то есть, массив $_GET обрабатывать не нужно.
	
### 5. Другие способы передачи данных 
	Фактически, данные, собранные на странице с помощью описанных ниже способов, будут преобразованы в URL-запрос и динамически добавлены в атрибут data-ff-popups-url (см. предыдущий способ передачи данных).
		
	5.1. Передача содержимого html-элементов с помощью селекторов

		Если необходимо собрать данные со страницы по селекторам, то в кнопку нужно добавить еще один атрибут: data-ff-popups-selectors="{'параметр':'селектор', ...}"
		В значении этого атрибута необходимо записать ассоциативный массив передаваемых параметров в формате JSON. Размерность массива может быть любой.
		Обратите внимание на то, что кавычки не совсем в стандарте JSON. По стандарту в JSON-массиве должны использоваться двойные кавычки: '{"параметр":"селектор", ...}'. Однако здесь допустимы оба варианта кавычек.
		
		Приведенный выше пример с параметром ff-form можно переписать так:
		<button  data-ff-popups-url="?block=22&single=1"  data-ff-popups-selectors="{'ff-form':{'data':{'product' : 'h1' , 'description' : '.shop .description'}}}">Заказать</button>

	5.2. Передача данных формы 

		Можно собрать данные со всех полей формы, в пределах которой находится кнопка всплывающей формы.
		На этот раз, имена передаваемых параметров нужно записать в атрибуты data-ff-popups-name соответсвующих полей:
		<form>
			<input type="text" data-ff-popups-name="ff-form[quantity]">
			<button data-ff-popups-url="?block=22&single=1">Заказать</button>
		</form>
		
### 6. Вызов окна, всплывающего на другие события
	Всплывающее окно можно вызывать на любое событие, а не только на щелчок по кнопке.
	$('селектор').on('событие', function() {
	    $.fpopup({url: ..., selectors: ..., size: ...});
	});
	Опции url, selectors, size соответствуют атрибутам data-ff-popups-url, data-ff-popups-selectors, data-ff-popups-size кнопок.
	Опция size может принимать значения: lg и sm. Эту опцию можно также настроить в окне редактирования шаблона ff/popups.
	
### 7. Расширения
**ff/popups/trigger.js** — управление модальными окнами, так чтобы они всплывали на определенные события, с определенной задержкой или только один раз в течение определенного срока.